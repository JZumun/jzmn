var jzmn=function(n){"use strict"
if("undefined"!=typeof n)throw new TypeError("'jzmn' already defined.")
var e=Array.prototype,r=function(n){return void 0===n||null===n?[]:Array.isArray(n)?n:n.length?e.slice.call(n):[n]},t=function(n,e){var u=e||[]
return r(n).forEach(function(n,e){Array.isArray(n)?t(n,u):u.push(n)}),u},u=function(n,e){var r=Object.create(u.fn)
return r.els="function"==typeof e?e(n):a(n),r.el=r.els[0],r}
u.fn={}
var a=null,i={}
u.setParser=function(n,e){e&&(i[n]=e),a=i[n]},u.setParser("default",r),u.extendFn=function(n,e){var r=Object.assign({input:"individual",output:"wrapped"},e)
return Object.keys(n).forEach(function(e){u.fn[e]=function(){var a,i=arguments
switch(r.input){case"array":a=t(n[e].bind(null,this.els).apply(null,i))
break
case"single":a=t(n[e].bind(null,this.el).apply(null,i))
break
case"individual":default:a=t(this.els.map(function(r){return n[e].bind(null,r).apply(null,i)}))}return{wrapped:u(a||this.els),bare:a.length>1?a:a[0],self:u(this.els),"bare || self":a.every(function(n){return void 0===n})?u(this.els):a.length>1?a:a[0]}[r.output]}}),n},u.extendFactory=function(n,e,r){var t=n?u[n]||(u[n]={}):u
return Object.keys(u.extendFn(e,r)).forEach(function(n,r){t[n]=e[n]}),u}
var l=function(n){return function(r,t,u){if(t){if(r.length||0===r.length)return e[n].call(r,t,u)
var a={}
return Object.keys(r)[n](function(n,e){var i=t.call(u||r,r[n],n,r)
return i&&(a[n]=i),i}),a}}}
return u.extendFn({at:function(n,e){return n[e]||[]}},{input:"array"}),u.extendFactory("util",{flatten:t,arrify:r,each:l("forEach"),map:l("map"),filter:l("filter"),reduce:function(n,r,t){return n.length||0===n.length?e.reduce.call(n,r,t):Object.keys(n).reduce(function(e,u,a){if(!a){if(!t)return n[u]
e=t}return r.call(n,e,n[u],u)},"")}},{input:"array"}),u}(jzmn)
